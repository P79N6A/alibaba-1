<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.culturecloud.dao.activity.CmsActivityEventMapper" >
  <resultMap id="BaseResultMap" type="com.culturecloud.model.bean.activity.CmsActivityEvent" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    <id column="EVENT_ID" property="eventId" jdbcType="VARCHAR" />
    <result column="ACTIVITY_ID" property="activityId" jdbcType="VARCHAR" />
    <result column="EVENT_DATE" property="eventDate" jdbcType="VARCHAR" />
    <result column="EVENT_END_DATE" property="eventEndDate" jdbcType="VARCHAR" />
    <result column="EVENT_TIME" property="eventTime" jdbcType="VARCHAR" />
    <result column="AVAILABLE_COUNT" property="availableCount" jdbcType="INTEGER" />
    <result column="EVENT_DATE_TIME" property="eventDateTime" jdbcType="VARCHAR" />
    <result column="SINGLE_EVENT" property="singleEvent" jdbcType="INTEGER" />
    <result column="SPIKE_TYPE" property="spikeType" jdbcType="INTEGER" />
    <result column="SPIKE_TIME" property="spikeTime" jdbcType="TIMESTAMP" />
    <result column="ORDER_PRICE" property="orderPrice" jdbcType="VARCHAR" />
    <result column="ORDER_COUNT" property="orderCount" jdbcType="INTEGER" />

  </resultMap>
  
  <resultMap type="com.culturecloud.dao.dto.activity.CmsActivityEventDto" id="BaseResultDtoMap" extends="BaseResultMap">
  	
  </resultMap>
  
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    EVENT_ID, ACTIVITY_ID, EVENT_DATE, EVENT_END_DATE, EVENT_TIME, AVAILABLE_COUNT, EVENT_DATE_TIME, 
    SINGLE_EVENT, SPIKE_TYPE, SPIKE_TIME, ORDER_PRICE,ORDER_COUNT
  </sql>
  
  <!--根据活动id查询活动场次信息 -->
  	<select id="queryActivityEventById" resultMap="BaseResultDtoMap" parameterType="java.util.Map">
		SELECT
		  IFNULL(ce.AVAILABLE_COUNT,0) AS counts,
		  ce.EVENT_TIME,
		  ce.EVENT_ID,
		  ce.EVENT_DATE_TIME,
		  ce.EVENT_DATE,
		  ce.EVENT_END_DATE,
		  IFNULL(ce.ORDER_PRICE,0) ORDER_PRICE,
		  ce.SPIKE_TIME
		FROM cms_activity_event ce
		WHERE 1 = 1
	    <if test="relatedId!=null">
	      AND ce.ACTIVITY_ID=#{relatedId}
	    </if>
		ORDER BY ce.EVENT_DATE_TIME ASC,ce.SPIKE_TIME
 	</select>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from cms_activity_event
    where EVENT_ID = #{eventId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    delete from cms_activity_event
    where EVENT_ID = #{eventId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.culturecloud.model.bean.activity.CmsActivityEvent" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    insert into cms_activity_event (EVENT_ID, ACTIVITY_ID, EVENT_DATE, 
      EVENT_END_DATE, EVENT_TIME, AVAILABLE_COUNT, 
      EVENT_DATE_TIME, SINGLE_EVENT, SPIKE_TYPE, 
      SPIKE_TIME, ORDER_PRICE)
    values (#{eventId,jdbcType=VARCHAR}, #{activityId,jdbcType=VARCHAR}, #{eventDate,jdbcType=VARCHAR}, 
      #{eventEndDate,jdbcType=VARCHAR}, #{eventTime,jdbcType=VARCHAR}, #{availableCount,jdbcType=INTEGER}, 
      #{eventDateTime,jdbcType=VARCHAR}, #{singleEvent,jdbcType=INTEGER}, #{spikeType,jdbcType=INTEGER}, 
      #{spikeTime,jdbcType=TIMESTAMP}, #{orderPrice,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.culturecloud.model.bean.activity.CmsActivityEvent" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    insert into cms_activity_event
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="eventId != null" >
        EVENT_ID,
      </if>
      <if test="activityId != null" >
        ACTIVITY_ID,
      </if>
      <if test="eventDate != null" >
        EVENT_DATE,
      </if>
      <if test="eventEndDate != null" >
        EVENT_END_DATE,
      </if>
      <if test="eventTime != null" >
        EVENT_TIME,
      </if>
      <if test="availableCount != null" >
        AVAILABLE_COUNT,
      </if>
      <if test="eventDateTime != null" >
        EVENT_DATE_TIME,
      </if>
      <if test="singleEvent != null" >
        SINGLE_EVENT,
      </if>
      <if test="spikeType != null" >
        SPIKE_TYPE,
      </if>
      <if test="spikeTime != null" >
        SPIKE_TIME,
      </if>
      <if test="orderPrice != null" >
        ORDER_PRICE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="eventId != null" >
        #{eventId,jdbcType=VARCHAR},
      </if>
      <if test="activityId != null" >
        #{activityId,jdbcType=VARCHAR},
      </if>
      <if test="eventDate != null" >
        #{eventDate,jdbcType=VARCHAR},
      </if>
      <if test="eventEndDate != null" >
        #{eventEndDate,jdbcType=VARCHAR},
      </if>
      <if test="eventTime != null" >
        #{eventTime,jdbcType=VARCHAR},
      </if>
      <if test="availableCount != null" >
        #{availableCount,jdbcType=INTEGER},
      </if>
      <if test="eventDateTime != null" >
        #{eventDateTime,jdbcType=VARCHAR},
      </if>
      <if test="singleEvent != null" >
        #{singleEvent,jdbcType=INTEGER},
      </if>
      <if test="spikeType != null" >
        #{spikeType,jdbcType=INTEGER},
      </if>
      <if test="spikeTime != null" >
        #{spikeTime,jdbcType=TIMESTAMP},
      </if>
      <if test="orderPrice != null" >
        #{orderPrice,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.culturecloud.model.bean.activity.CmsActivityEvent" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    update cms_activity_event
    <set >
      <if test="activityId != null" >
        ACTIVITY_ID = #{activityId,jdbcType=VARCHAR},
      </if>
      <if test="eventDate != null" >
        EVENT_DATE = #{eventDate,jdbcType=VARCHAR},
      </if>
      <if test="eventEndDate != null" >
        EVENT_END_DATE = #{eventEndDate,jdbcType=VARCHAR},
      </if>
      <if test="eventTime != null" >
        EVENT_TIME = #{eventTime,jdbcType=VARCHAR},
      </if>
      <if test="availableCount != null" >
        AVAILABLE_COUNT = #{availableCount,jdbcType=INTEGER},
      </if>
      <if test="eventDateTime != null" >
        EVENT_DATE_TIME = #{eventDateTime,jdbcType=VARCHAR},
      </if>
      <if test="singleEvent != null" >
        SINGLE_EVENT = #{singleEvent,jdbcType=INTEGER},
      </if>
      <if test="spikeType != null" >
        SPIKE_TYPE = #{spikeType,jdbcType=INTEGER},
      </if>
      <if test="spikeTime != null" >
        SPIKE_TIME = #{spikeTime,jdbcType=TIMESTAMP},
      </if>
      <if test="orderPrice != null" >
        ORDER_PRICE = #{orderPrice,jdbcType=VARCHAR},
      </if>
    </set>
    where EVENT_ID = #{eventId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.culturecloud.model.bean.activity.CmsActivityEvent" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 25 14:37:37 CST 2016.
    -->
    update cms_activity_event
    set ACTIVITY_ID = #{activityId,jdbcType=VARCHAR},
      EVENT_DATE = #{eventDate,jdbcType=VARCHAR},
      EVENT_END_DATE = #{eventEndDate,jdbcType=VARCHAR},
      EVENT_TIME = #{eventTime,jdbcType=VARCHAR},
      AVAILABLE_COUNT = #{availableCount,jdbcType=INTEGER},
      EVENT_DATE_TIME = #{eventDateTime,jdbcType=VARCHAR},
      SINGLE_EVENT = #{singleEvent,jdbcType=INTEGER},
      SPIKE_TYPE = #{spikeType,jdbcType=INTEGER},
      SPIKE_TIME = #{spikeTime,jdbcType=TIMESTAMP},
      ORDER_PRICE = #{orderPrice,jdbcType=VARCHAR}
    where EVENT_ID = #{eventId,jdbcType=VARCHAR}
  </update>
</mapper>