<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sun3d.why.dao.CcpSpecialYcodeMapper" >
  <resultMap id="BaseResultMap" type="com.culturecloud.model.bean.special.CcpSpecialYcode" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    <id column="code_id" property="codeId" jdbcType="VARCHAR" />
    <result column="ycode" property="ycode" jdbcType="VARCHAR" />
    <result column="customer_id" property="customerId" jdbcType="VARCHAR" />
    <result column="use_activity_id" property="useActivityId" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="code_status" property="codeStatus" jdbcType="INTEGER" />
    <result column="ycode_create_time" property="ycodeCreateTime" jdbcType="TIMESTAMP" />
    <result column="ycode_use_time" property="ycodeUseTime" jdbcType="TIMESTAMP" />
  </resultMap>
  
  <resultMap type="com.sun3d.why.dao.dto.CcpSpecialYcodeDto" id="BaseResultDtoMap" extends="BaseResultMap">
  	
  	<result column="userName" property="userName" jdbcType="VARCHAR" />
  	<result column="useActivityName" property="useActivityName" jdbcType="VARCHAR" />
  	
  </resultMap>
  
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    code_id, ycode, customer_id, use_activity_id, user_id, code_status, ycode_create_time, 
    ycode_use_time
  </sql>
  
  
  <select id="queryCodeCountByCondition" resultType="java.lang.Integer" parameterType="java.util.Map">
  
   SELECT count(*) FROM ccp_special_ycode c WHERE c.customer_id=#{customerId}
   
  </select>
  
  <select id="queryCodeByCondition" resultMap="BaseResultDtoMap" parameterType="java.util.Map">
  
    SELECT 
  c.code_id, c.ycode, c.customer_id, c.use_activity_id, c.user_id, c.code_status, c.ycode_create_time, 
    c.ycode_use_time,u.USER_NAME as userName, a.ACTIVITY_NAME as useActivityName
 	FROM ccp_special_ycode c
 	
 	left join cms_terminal_user u on u.user_id = c.user_id
 	
 	left join cms_activity a on a.ACTIVITY_ID = c.use_activity_id
 	
 	 WHERE c.customer_id=#{customerId}
    
      order by ycode_create_time DESC,code_id DESC
    <if test="firstResult != null">
      limit #{firstResult},#{rows}
  </if>
  </select>
  
  <select id="queryCodeCountByYcode" resultType="java.lang.Integer" parameterType="java.lang.String"> 
 	 SELECT count(*) FROM ccp_special_ycode c WHERE c.ycode=#{ycode}
  </select>
  
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from ccp_special_ycode
    where code_id = #{codeId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    delete from ccp_special_ycode
    where code_id = #{codeId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.culturecloud.model.bean.special.CcpSpecialYcode" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    insert into ccp_special_ycode (code_id, ycode, customer_id, 
      use_activity_id, user_id, code_status, 
      ycode_create_time, ycode_use_time)
    values (#{codeId,jdbcType=VARCHAR}, #{ycode,jdbcType=VARCHAR}, #{customerId,jdbcType=VARCHAR}, 
      #{useActivityId,jdbcType=VARCHAR}, #{userId,jdbcType=VARCHAR}, #{codeStatus,jdbcType=INTEGER}, 
      #{ycodeCreateTime,jdbcType=TIMESTAMP}, #{ycodeUseTime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.culturecloud.model.bean.special.CcpSpecialYcode" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    insert into ccp_special_ycode
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="codeId != null" >
        code_id,
      </if>
      <if test="ycode != null" >
        ycode,
      </if>
      <if test="customerId != null" >
        customer_id,
      </if>
      <if test="useActivityId != null" >
        use_activity_id,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="codeStatus != null" >
        code_status,
      </if>
      <if test="ycodeCreateTime != null" >
        ycode_create_time,
      </if>
      <if test="ycodeUseTime != null" >
        ycode_use_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="codeId != null" >
        #{codeId,jdbcType=VARCHAR},
      </if>
      <if test="ycode != null" >
        #{ycode,jdbcType=VARCHAR},
      </if>
      <if test="customerId != null" >
        #{customerId,jdbcType=VARCHAR},
      </if>
      <if test="useActivityId != null" >
        #{useActivityId,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=VARCHAR},
      </if>
      <if test="codeStatus != null" >
        #{codeStatus,jdbcType=INTEGER},
      </if>
      <if test="ycodeCreateTime != null" >
        #{ycodeCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="ycodeUseTime != null" >
        #{ycodeUseTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.culturecloud.model.bean.special.CcpSpecialYcode" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    update ccp_special_ycode
    <set >
      <if test="ycode != null" >
        ycode = #{ycode,jdbcType=VARCHAR},
      </if>
      <if test="customerId != null" >
        customer_id = #{customerId,jdbcType=VARCHAR},
      </if>
      <if test="useActivityId != null" >
        use_activity_id = #{useActivityId,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        user_id = #{userId,jdbcType=VARCHAR},
      </if>
      <if test="codeStatus != null" >
        code_status = #{codeStatus,jdbcType=INTEGER},
      </if>
      <if test="ycodeCreateTime != null" >
        ycode_create_time = #{ycodeCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="ycodeUseTime != null" >
        ycode_use_time = #{ycodeUseTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where code_id = #{codeId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.culturecloud.model.bean.special.CcpSpecialYcode" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Sep 27 23:47:17 CST 2016.
    -->
    update ccp_special_ycode
    set ycode = #{ycode,jdbcType=VARCHAR},
      customer_id = #{customerId,jdbcType=VARCHAR},
      use_activity_id = #{useActivityId,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=VARCHAR},
      code_status = #{codeStatus,jdbcType=INTEGER},
      ycode_create_time = #{ycodeCreateTime,jdbcType=TIMESTAMP},
      ycode_use_time = #{ycodeUseTime,jdbcType=TIMESTAMP}
    where code_id = #{codeId,jdbcType=VARCHAR}
  </update>
</mapper>