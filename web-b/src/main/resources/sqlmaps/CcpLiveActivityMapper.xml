<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sun3d.why.dao.CcpLiveActivityMapper">
  <resultMap id="BaseResultMap" type="com.culturecloud.model.bean.live.CcpLiveActivity">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 13 18:43:54 CST 2017.
    -->
    <id column="live_activity_id" jdbcType="VARCHAR" property="liveActivityId" />
    <result column="live_title" jdbcType="VARCHAR" property="liveTitle" />
    <result column="live_top_text" jdbcType="VARCHAR" property="liveTopText" />
    <result column="live_cover_img" jdbcType="VARCHAR" property="liveCoverImg" />
    <result column="live_start_time" jdbcType="TIMESTAMP" property="liveStartTime" />
    <result column="live_create_time" jdbcType="TIMESTAMP" property="liveCreateTime" />
    <result column="live_create_user" jdbcType="VARCHAR" property="liveCreateUser" />
    <result column="live_status" jdbcType="INTEGER" property="liveStatus" />
    <result column="live_is_del" jdbcType="INTEGER" property="liveIsDel" />
    <result column="live_end_time" jdbcType="TIMESTAMP" property="liveEndTime" />
    <result column="live_type" jdbcType="INTEGER" property="liveType" />
    <result column="live_check" jdbcType="INTEGER" property="liveCheck" />
    <result column="live_check_time" jdbcType="TIMESTAMP" property="liveCheckTime" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 13 18:43:54 CST 2017.
    -->
    live_activity_id, live_title, live_top_text, live_cover_img, live_start_time, live_create_time, 
    live_create_user, live_status, live_is_del, live_end_time, live_type, live_check, 
    live_check_time
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 13 18:43:54 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from ccp_live_activity
    where live_activity_id = #{liveActivityId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 13 18:43:54 CST 2017.
    -->
    delete from ccp_live_activity
    where live_activity_id = #{liveActivityId,jdbcType=VARCHAR}
  </delete>
 <insert id="insert" parameterType="com.culturecloud.model.bean.live.CcpLiveActivity">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 14 20:33:31 CST 2017.
    -->
    insert into ccp_live_activity (live_activity_id, live_title, live_top_text, 
      live_cover_img, live_start_time, live_create_time, 
      live_create_user, live_status, live_is_del, 
      live_end_time, live_type, live_check, 
      live_check_time)
    values (#{liveActivityId,jdbcType=VARCHAR}, #{liveTitle,jdbcType=VARCHAR}, #{liveTopText,jdbcType=VARCHAR}, 
      #{liveCoverImg,jdbcType=VARCHAR}, #{liveStartTime,jdbcType=TIMESTAMP}, #{liveCreateTime,jdbcType=TIMESTAMP}, 
      #{liveCreateUser,jdbcType=VARCHAR}, #{liveStatus,jdbcType=INTEGER}, #{liveIsDel,jdbcType=INTEGER}, 
      #{liveEndTime,jdbcType=TIMESTAMP}, #{liveType,jdbcType=INTEGER}, #{liveCheck,jdbcType=INTEGER}, 
      #{liveCheckTime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.culturecloud.model.bean.live.CcpLiveActivity">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 14 20:33:31 CST 2017.
    -->
    insert into ccp_live_activity
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="liveActivityId != null">
        live_activity_id,
      </if>
      <if test="liveTitle != null">
        live_title,
      </if>
      <if test="liveTopText != null">
        live_top_text,
      </if>
      <if test="liveCoverImg != null">
        live_cover_img,
      </if>
      <if test="liveStartTime != null">
        live_start_time,
      </if>
      <if test="liveCreateTime != null">
        live_create_time,
      </if>
      <if test="liveCreateUser != null">
        live_create_user,
      </if>
      <if test="liveStatus != null">
        live_status,
      </if>
      <if test="liveIsDel != null">
        live_is_del,
      </if>
      <if test="liveEndTime != null">
        live_end_time,
      </if>
      <if test="liveType != null">
        live_type,
      </if>
      <if test="liveCheck != null">
        live_check,
      </if>
      <if test="liveCheckTime != null">
        live_check_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="liveActivityId != null">
        #{liveActivityId,jdbcType=VARCHAR},
      </if>
      <if test="liveTitle != null">
        #{liveTitle,jdbcType=VARCHAR},
      </if>
      <if test="liveTopText != null">
        #{liveTopText,jdbcType=VARCHAR},
      </if>
      <if test="liveCoverImg != null">
        #{liveCoverImg,jdbcType=VARCHAR},
      </if>
      <if test="liveStartTime != null">
        #{liveStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="liveCreateTime != null">
        #{liveCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="liveCreateUser != null">
        #{liveCreateUser,jdbcType=VARCHAR},
      </if>
      <if test="liveStatus != null">
        #{liveStatus,jdbcType=INTEGER},
      </if>
      <if test="liveIsDel != null">
        #{liveIsDel,jdbcType=INTEGER},
      </if>
      <if test="liveEndTime != null">
        #{liveEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="liveType != null">
        #{liveType,jdbcType=INTEGER},
      </if>
      <if test="liveCheck != null">
        #{liveCheck,jdbcType=INTEGER},
      </if>
      <if test="liveCheckTime != null">
        #{liveCheckTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.culturecloud.model.bean.live.CcpLiveActivity">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 14 20:33:31 CST 2017.
    -->
    update ccp_live_activity
    <set>
      <if test="liveTitle != null">
        live_title = #{liveTitle,jdbcType=VARCHAR},
      </if>
      <if test="liveTopText != null">
        live_top_text = #{liveTopText,jdbcType=VARCHAR},
      </if>
      <if test="liveCoverImg != null">
        live_cover_img = #{liveCoverImg,jdbcType=VARCHAR},
      </if>
      <if test="liveStartTime != null">
        live_start_time = #{liveStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="liveCreateTime != null">
        live_create_time = #{liveCreateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="liveCreateUser != null">
        live_create_user = #{liveCreateUser,jdbcType=VARCHAR},
      </if>
      <if test="liveStatus != null">
        live_status = #{liveStatus,jdbcType=INTEGER},
      </if>
      <if test="liveIsDel != null">
        live_is_del = #{liveIsDel,jdbcType=INTEGER},
      </if>
      <if test="liveEndTime != null">
        live_end_time = #{liveEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="liveType != null">
        live_type = #{liveType,jdbcType=INTEGER},
      </if>
      <if test="liveCheck != null">
        live_check = #{liveCheck,jdbcType=INTEGER},
      </if>
      <if test="liveCheckTime != null">
        live_check_time = #{liveCheckTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where live_activity_id = #{liveActivityId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.culturecloud.model.bean.live.CcpLiveActivity">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Tue Mar 14 20:33:31 CST 2017.
    -->
    update ccp_live_activity
    set live_title = #{liveTitle,jdbcType=VARCHAR},
      live_top_text = #{liveTopText,jdbcType=VARCHAR},
      live_cover_img = #{liveCoverImg,jdbcType=VARCHAR},
      live_start_time = #{liveStartTime,jdbcType=TIMESTAMP},
      live_create_time = #{liveCreateTime,jdbcType=TIMESTAMP},
      live_create_user = #{liveCreateUser,jdbcType=VARCHAR},
      live_status = #{liveStatus,jdbcType=INTEGER},
      live_is_del = #{liveIsDel,jdbcType=INTEGER},
      live_end_time = #{liveEndTime,jdbcType=TIMESTAMP},
      live_type = #{liveType,jdbcType=INTEGER},
      live_check = #{liveCheck,jdbcType=INTEGER},
      live_check_time = #{liveCheckTime,jdbcType=TIMESTAMP}
    where live_activity_id = #{liveActivityId,jdbcType=VARCHAR}
  </update>
	<resultMap extends="BaseResultMap" id="BaseResultDtoMap" type="com.sun3d.why.dao.dto.CcpLiveActivityDto">

	</resultMap>

	<select id="selectLiveActivityCount" parameterType="java.util.Map" resultType="java.lang.Integer">

		select
		count(*)
		from ccp_live_activity	

		where 1=1
		
			
		<choose>
			<when test="liveActivityTimeStatus==3">
				 and live_status= 2
			 </when>
			  <when test="liveActivityTimeStatus==0">
				 and live_status != 0
			 </when>
			 <otherwise>
			 	<if test="liveStatus!=null">
					and live_status=#{liveStatus}
					</if>		
			 </otherwise>
		</choose>
		<if test="liveActivityTimeStatus==1">
		and live_start_time &lt;= CURRENT_TIMESTAMP and live_status= 1
		</if>
		<if test="liveActivityTimeStatus==2">
		and (live_start_time &gt; CURRENT_TIMESTAMP or live_status= 0)
		</if>
		<if test="liveCreateUser != null">
		and live_create_user=#{liveCreateUser}
		</if>
		<if test="liveType!= null">
		and live_type =#{liveType}
		</if>
		<if test="liveCheck != null">
		and live_check=#{liveCheck}
		</if>
		and live_is_del = 1

	</select>

	<select id="selectLiveActivityList" parameterType="java.util.Map" resultMap="BaseResultDtoMap">

		select
		a.*,u.USER_NICK_NAME AS userName,u.USER_HEAD_IMG_URL AS userHeadImgUrl
		from ccp_live_activity a
		
		left join sys_user u on u.user_id = a.live_create_user

		where 1=1
		
		<choose>
			 <when test="liveActivityTimeStatus==3">
				 and live_status= 2
			 </when>
			  <when test="liveActivityTimeStatus==0">
				 and live_status != 0
			 </when>
			 <otherwise>
			 	<if test="liveStatus!=null">
					and live_status=#{liveStatus}
					</if>		
			 </otherwise>
		</choose>
		<if test="liveActivityTimeStatus==1">
		and live_start_time &lt;= CURRENT_TIMESTAMP and live_status= 1
		</if>
		<if test="liveActivityTimeStatus==2">
		and (live_start_time &gt; CURRENT_TIMESTAMP or live_status= 0)
		</if>
		<if test="liveCreateUser != null">
		and live_create_user=#{liveCreateUser}
		</if>
		<if test="liveType!= null">
		and live_type =#{liveType}
		</if>
		<if test="liveCheck != null">
		and live_check=#{liveCheck}
		</if>
		and live_is_del = 1
		
		order by live_create_time desc 
		
		  limit ${firstResult},${rows}
	</select>
	
</mapper>